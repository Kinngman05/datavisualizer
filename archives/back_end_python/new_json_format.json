{
    "databases": {
        "test_db": {
            "students": {
                "table_constrains": {
                    "name": "VARCHAR(60) NOT NULL",
                    "id": "CHAR(10) NOT NULL",
                    "login_status": "ENUM('YES','NO') NOT NULL DEFAULT 'NO'"
                },
                "read_list": null,
                "index_constrains": [
                    [
                        "id"
                    ],
                    [
                        "id",
                        "name"
                    ]
                ],
                "primary_key": "id",
                "foreign_key": null
            },
            "teams": {
                "table_constrains": {
                    "team_hash": "CHAR(10) NOT NULL",
                    "team_name": "VARCHAR(30) NOT NULL",
                    "team_lead": "CHAR(10) NOT NULL"
                },
                "read_list": null,
                "index_constrains": [
                    [
                        "team_hash"
                    ]
                ],
                "primary_key": "team_hash",
                "foreign_key": [
                    {
                        "constraint_name": "foreign_key_name",
                        "foreign_table_name": "students",
                        "parent_attribute": [
                            "id"
                        ],
                        "child_attribute": [
                            "team_lead"
                        ]
                    }
                ]
            },
            "attendance": {
                "table_constrains": {
                    "id": "CHAR(10) NOT NULL",
                    "team_hash": "CHAR(6) NOT NULL ",
                    "time_in": "DATETIME NOT NULL DEFAULT NOW()",
                    "time_out": "DATETIME DEFAULT NULL",
                    "time_spent": "TIME DEFAULT NULL"
                },
                "read_list": null,
                "index_constrains": null,
                "primary_key": null,
                "foreign_key": [
                    {
                        "constraint_name": null,
                        "foreign_table_name": "students",
                        "parent_attribute": [
                            "id"
                        ],
                        "child_attribute": [
                            "id"
                        ]
                    },
                    {
                        "constraint_name": null,
                        "foreign_table_name": "teams",
                        "parent_attribute": [
                            "team_hash"
                        ],
                        "child_attribute": [
                            "team_hash"
                        ]
                    }
                ]
            }
        }
    },
    "procedures": {
        "set_login_status_to_True": {
            "parameters": [
                "IN _id CHAR(10)"
            ],
            "queries": [
                "UPDATE students SET login_status=TRUE WHERE id=_id;"
            ]
        },
        "set_login_status_to_False": {
            "parameters": [
                "IN _id CHAR(10)"
            ],
            "queries": [
                "UPDATE students SET login_status=FALSE WHERE id=_id;"
            ]
        }
    },
    "triggers": {
        "attendance_AFTER_INSERT": {
            "time": "AFTER",
            "event": "INSERT",
            "database_name": "test_db",
            "table_name": "attendance",
            "queries": [
                "CALL set_login_status_to_True(NEW.id);"
            ]
        },
        "attendance_BEFORE_UPDATE": {
            "time": "BEFORE",
            "event": "UPDATE",
            "database_name": "test_db",
            "table_name": "attendance",
            "queries": [
                "IF OLD.time_spent IS NULL THEN SET NEW.time_spent=TIMEDIFF(NEW.time_out,OLD.time_in); END IF;",
                "CALL set_login_status_to_False(NEW.id);"
            ]
        }
    }
}